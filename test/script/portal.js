/* portal.js */

ui.debug.addDebugData("portal", {
	url: "6/6/g1h2m1j3g2h4o43h",
	failcheck: [
		[
			"lnBranch",
			"pzprv3/portal/6/6/. 1 . . 2 . /. . . . . . /1 . . . . 3 /. 2 . . 4 . /. . . . . . /. . 4 3 . . /0 1 1 1 0 /0 0 0 0 0 /0 0 0 0 0 /0 0 0 0 0 /0 0 0 0 0 /0 0 0 0 0 /0 0 1 0 0 0 /0 0 0 0 0 0 /0 0 0 0 0 0 /0 0 0 0 0 0 /0 0 0 0 0 0 /"
		],
		[
			"lnCross",
			"pzprv3/portal/6/6/. 1 . . 2 . /. . . . . . /1 . . . . 3 /. 2 . . 4 . /. . . . . . /. . 4 3 . . /0 0 0 1 0 /0 0 0 0 0 /0 0 1 1 1 /0 1 0 0 0 /0 0 0 1 0 /0 0 0 1 0 /0 0 0 1 0 0 /0 0 0 1 0 0 /0 0 1 1 0 0 /0 0 0 1 0 0 /0 0 0 0 1 0 /"
		],
		[
			"lnPortalCross",
			"pzprv3/portal/6/6/. 1 . . 2 . /. . . . . . /1 . . . . 3 /. 2 . . 4 . /. . . . . . /. . 4 3 . . /1 1 1 0 1 /0 1 0 0 1 /1 0 0 1 0 /1 0 1 0 0 /0 1 0 0 0 /1 0 0 0 1 /1 0 0 1 0 1 /1 1 1 1 1 0 /0 0 1 0 0 1 /1 0 0 1 1 1 /1 1 1 1 1 1 /"
		],
		[
			"ceNoLine",
			"pzprv3/portal/6/6/. 1 . . 2 . /. . . . . . /1 . . . . 3 /. 2 . . 4 . /. . . . . . /. . 4 3 . . /1 0 1 0 1 /1 1 0 0 1 /1 1 0 1 0 /1 0 0 0 0 /1 1 0 0 0 /0 0 0 0 0 /1 0 1 1 0 1 /0 0 0 1 1 0 /0 0 1 0 0 0 /1 0 1 0 0 0 /0 0 0 0 0 0 /"
		],
		[
			"ceNoLine",
			"pzprv3/portal/3/2/. . /. . /1 1 /1 /1 /0 /1 1 /0 0 /",
			{ skiprules: true }
		],
		[
			"lnCurveOnCir",
			"pzprv3/portal/3/3/. . 1 /. . - /1 . . /1 1 /1 1 /1 1 /1 0 0 /0 0 1 /"
		],
		[
			"lnPortalCurve",
			"pzprv3/portal/6/6/. 1 . . 2 . /. . . . . . /1 . . . . 3 /. 2 . . 4 . /. . . . . . /. . 4 3 . . /1 0 1 0 1 /1 1 0 0 1 /1 1 0 1 0 /1 0 1 1 0 /0 1 1 1 0 /1 0 1 0 1 /1 0 1 1 0 1 /0 0 0 1 1 0 /0 0 1 0 0 1 /1 0 0 0 0 1 /1 1 0 0 1 1 /"
		],
		[
			null,
			"pzprv3/portal/3/3/. . 1 /. . - /1 . . /1 0 /0 0 /0 1 /1 1 1 /1 1 1 /",
			{ skiprules: true }
		],
		[
			"lnDeadEnd",
			"pzprv3/portal/6/6/. 1 . . 2 . /. . . . . . /1 . . . . 3 /. 2 . . 4 . /. . . . . . /. . 4 3 . . /1 0 1 0 1 /1 1 0 0 1 /1 1 0 1 0 /1 0 1 0 0 /0 1 0 0 0 /1 0 0 0 1 /1 0 1 1 0 1 /0 0 0 1 1 0 /0 0 0 0 0 1 /1 0 0 1 1 1 /1 1 1 1 1 1 /"
		],
		[
			"cePortalMiscount",
			"pzprv3/portal/4/4/. 1 . . /. . . 1 /. . 1 . /. . . . /1 1 1 /0 1 0 /0 0 0 /1 0 1 /1 0 0 1 /1 1 1 1 /1 1 1 1 /",
			{ skiprules: true }
		],
		[
			"lnPlLoop",
			"pzprv3/portal/6/6/. 1 . . 2 . /. . . . . . /1 . . . . 3 /. 2 . . 4 . /. . . . . . /. . 4 3 . . /1 0 1 0 1 /1 0 0 0 1 /1 0 0 1 0 /1 0 1 0 0 /0 1 0 0 0 /1 0 0 0 1 /1 0 1 1 0 1 /0 1 1 1 1 0 /0 0 1 0 0 1 /1 0 0 1 1 1 /1 1 1 1 1 1 /"
		],
		[
			null,
			"pzprv3/portal/6/6/. 1 . . 2 . /. . . . . . /1 . . . . 3 /. 2 . . 4 . /. . . . . . /. . 4 3 . . /1 0 1 0 1 /1 1 0 0 1 /1 1 0 1 0 /1 0 1 0 0 /0 1 0 0 0 /1 0 0 0 1 /1 0 1 1 0 1 /0 0 0 1 1 0 /0 0 1 0 0 1 /1 0 0 1 1 1 /1 1 1 1 1 1 /"
		]
	],
	inputs: [
		{
			label: "Input numbers",
			input: [
				"newboard,3,3",
				"editmode",
				"cursor,1,1",
				"key,1",
				"cursor,5,5",
				"key,1"
			],
			result:
				"pzprv3/portal/3/3/1 . . /. . . /. . 1 /0 0 /0 0 /0 0 /0 0 0 /0 0 0 /"
		},
		{
			label: "Drawing connectivity",
			input: [
				"playmode",
				"mouse,left,1,1,5,1",
				"mouse,left,1,3,5,3",
				"mouse,left,1,5,5,5",
				"playmode,info-line",
				"mouse,left,2,1"
			],
			result: function(puzzle, assert) {
				var bd = puzzle.board;
				assert.equal(bd.getb(2, 1).qinfo, 1);
				assert.equal(bd.getb(2, 3).qinfo, -1);
				assert.equal(bd.getb(2, 5).qinfo, 1);
			}
		},
		{
			label: "Number connectivity",
			input: ["cursor,1,3", "key,2", "cursor,1,5", "key,2"],
			result: function(puzzle, assert) {
				var bd = puzzle.board;
				var color = bd.getc(1, 1).path.color;
				assert(color);

				bd.getc(1, 3).setNum(-1);
				bd.getc(1, 5).setNum(-1);

				var color1 = bd.getc(1, 1).path.color,
					color2 = bd.getc(1, 3).path.color;
				assert.notEqual(color1, color2);
				assert(color1 === color || color2 === color);
			}
		},
		{
			label: "Prevent connecting identical adjacent portals",
			input: [
				"newboard,6,1",
				"editmode",
				"cursor,5,1",
				"key,1",
				"cursor,7,1",
				"key,1",
				"cursor,11,1",
				"key,w",
				"playmode,auto",
				"mouse,left,1,1,11,1"
			],
			result: "pzprv3/portal/1/6/. . 1 1 . # /1 1 0 1 0 /"
		},
		{
			label: "Remove existing lines when entering portals",
			input: ["editmode", "cursor,3,1", "key,2", "cursor,5,1", "key,2"],
			result: "pzprv3/portal/1/6/. 2 2 1 . # /1 0 0 1 0 /"
		}
	]
});
